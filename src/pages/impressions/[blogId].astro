---
import ContentPage from '../../layouts/ContentPage.astro';
import { applySyntaxHighlight } from '../../library/highlight';
import { getBlogDetail, getBlogs } from '../../library/microcms';

export async function getStaticPaths() {
  const impressions = await getBlogs({
    fields: ['id'],
    filters: 'category[contains]impression',
  });
  return impressions.contents.map((impression) => ({
    params: { blogId: impression.id },
  }));
}

const impressionId = Astro.params.blogId;
const impression = await getBlogDetail(impressionId);
const highlightedImpression = {
  ...impression,
  content: applySyntaxHighlight(impression.content),
};
---

<ContentPage {...highlightedImpression}>
  <div set:html={highlightedImpression.content} />
</ContentPage>
