---
import ContentPage from '../../layouts/ContentPage.astro';
import { applySyntaxHighlight } from '../../library/highlight';
import { getBlogDetail, getBlogs } from '../../library/microcms';

export async function getStaticPaths() {
  const posts = await getBlogs({
    fields: ['id'],
    filters: 'category[contains]post',
  });
  return posts.contents.map((post) => ({
    params: { blogId: post.id },
  }));
}

const postId = Astro.params.blogId;
const post = await getBlogDetail(postId);
const highlightedPost = {
  ...post,
  content: applySyntaxHighlight(post.content),
};
---

<ContentPage {...highlightedPost}>
  <div set:html={highlightedPost.content} />
</ContentPage>
